var express=require("express"),util=require("util");module.exports=function(s,o){var n=function(s,o,n){var e=function(s,o){return s[o]};return s.split(o).reduce(e,n)};s.post("/autoparams",function(s,n){o.connect(),console.log(JSON.stringify(s.body)+" params:"+JSON.stringify(s.params));var e={};e=s.body,e.session=s.session,s.session&&s.session.passport&&(e.session_user=s.session.passport.user),o.saveAutoParams(e,function(s){e.__SessionId=s,o.loadAutoParams(e,function(){console.log("After Load Params"+JSON.stringify(e)),n.json(e)})})}),s.post("/connect",function(s,o){console.log(s.body+" params:"+s.params);var n=s.body,e=global[n.function],a=n.__SessionId,i=e(a);o.json(i)}),s.post("/autoSaveData",function(s,n){console.log(JSON.stringify(s.body)+" params:"+JSON.stringify(s.params));var e=s.body;e.session=s.session,s.session&&s.session.passport&&(e.session_user=s.session.passport.user);e.__SessionId;console.log("\n\n::"+global.testEvent+"&&"+e.__EventName+":::"+e.__SessionId),o.connect(),o.saveAutoTable(e,function(s){e.__SessionId=s,e.__Status="Successfully Saved.",global._params=e,console.log("\n\nSaveTable Params="+JSON.stringify(e)),n.json(e)})}),s.post("/autoLoadData",function(s,n){console.log(JSON.stringify(s.body)+" params:"+JSON.stringify(s.params));var e=s.body;e.__SessionId;e.session=s.session,s.session&&s.session.passport&&(e.session_user=s.session.passport.user),console.log("\n\nsession::"+JSON.stringify(s.session)+" &&"+e.session_user+":::"+e.__SessionId),o.connect(),o.loadAutoTable(e,function(s){e.__SessionId=s,global._params=e,console.log("LoadTable Params="+JSON.stringify(e)),n.json(e)})}),s.post("/executeEvent",function(s,e){console.log(JSON.stringify(s.body)+"obj::"+s.body+" params:"+JSON.stringify(s.params));var a=JSON.parse(JSON.stringify(s.body));a.session=s.session,s.session&&s.session.passport&&(a.session_user=s.session.passport.user);var i=a.__SessionId;console.log("::"+r+"&&"+a.__EventName+":::"+a.__SessionId);var r=n(a.__EventName,".",global);a.__SessionId=i,global._params=a;console.log("Execute fn= "+r+" Params="+JSON.stringify(a)),r(a,function(){o.saveAutoParams(a,function(){o.loadAutoParams(a,function(){console.log("\n\n SUCCESS:: After Load Params"+JSON.stringify(a)),e.json(a)})})})})};